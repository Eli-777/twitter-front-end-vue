(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a473badc"],{1660:function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container"},[r("Navbar",{attrs:{"initial-now-page":e.nowPage}}),r("CurrentUserCard",{key:e.componentKey,attrs:{"initial-user":e.User}}),r("MostFollowerUserRecommend",{on:{"after-add-follow-user":e.afteraddFollowUser,"after-delete-follow-user":e.afterdeleteFollowUser}}),r("UserPageEdit",{attrs:{"initial-user":e.User,"initial-is-processing":e.isProcessing},on:{"after-submit":e.handleAfterSubmit}}),r("TweetCreate",{on:{"after-create-tweet":e.afterCreateTweet}})],1)},a=[],n=(r("96cf"),r("1da1")),i=r("5530"),o=r("d178"),c=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"center-area",staticStyle:{width:"33rem"}},[s("div",{staticClass:"header"},[s("button",{staticClass:"header-button",attrs:{type:"button"},on:{click:function(t){return e.$router.back()}}},[e._v("←")]),s("div",{staticClass:"header-text m-3"},[s("p",{staticClass:"header-name"},[e._v(e._s(e.user.name))]),s("p",{staticClass:"header-userTweets"},[e._v(e._s(e.user.tweetCount)+"推文")])])]),s("img",{staticClass:"card-img-top backgroundImage",attrs:{src:e._f("emptyImage")(e.user.cover),height:"150px"}}),s("div",{staticClass:"card-body"},[s("img",{staticClass:"card-img-avatar",attrs:{src:e._f("emptyImage")(e.user.avatar),height:"140px",width:"140px"}}),s("div",{staticClass:"card-body-button"},[e.currentUser.id===this.user.id?s("button",{staticClass:"btn edit-profile-button",attrs:{"data-toggle":"modal","data-target":"#user-edit-modal"}},[e._v("編輯個人資料")]):s("button",{staticClass:"button-transparent"},[s("img",{attrs:{src:r("1cfa")}})]),e.user.isBelled&&e.currentUser.id!==this.user.id?s("button",{staticClass:"button-transparent-active",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.deleteBell(t)}}},[s("img",{attrs:{src:r("5e13")}})]):e._e(),e.user.isBelled||e.currentUser.id===this.user.id?e._e():s("button",{staticClass:"button-transparent",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.addBell(t)}}},[s("img",{attrs:{src:r("fd6e")}})]),e.user.isFollowed||e.currentUser.id===this.user.id?e._e():s("button",{staticClass:"btn button-follow",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.addFollow(t)}}},[e._v("跟隨")]),e.user.isFollowed&&e.currentUser.id!==this.user.id?s("button",{staticClass:"btn button-following",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.deleteFollow(t)}}},[e._v("正在跟隨")]):e._e()]),s("div",{staticClass:"card-body-text"},[s("h5",{staticClass:"card-body-name"},[e._v(e._s(e.user.name))]),s("p",{staticClass:"card-body-account"},[e._v("@"+e._s(e.user.account))]),s("p",{staticClass:"card-body-introduction"},[e._v(e._s(e.user.introduction))])]),s("div",{staticClass:"card-body-follow"},[s("router-link",{attrs:{to:{name:"user-following",params:{id:e.currentUser.id}}}},[e._v(" "+e._s(e.user.followingCount)+" 個 "),s("span",[e._v("跟隨中")])]),s("router-link",{attrs:{to:{name:"user-follower",params:{id:e.currentUser.id}}}},[e._v(" "+e._s(e.user.followerCount)+" 位 "),s("span",[e._v("跟隨者")])])],1)]),s("ul",{staticClass:"nav nav-pills",attrs:{id:"nav-tab",role:"tablist"}},[s("li",{staticClass:"nav-item",on:{click:function(t){return e.showtweets("userTweet")}}},[s("router-link",{staticClass:"nav-link active",attrs:{to:"#","data-toggle":"tab",href:"#nav-home",role:"tab","aria-controls":"nav-home","aria-selected":"true"}},[e._v("推文")])],1),s("li",{staticClass:"nav-item",on:{click:function(t){return e.showtweets("replied")}}},[s("router-link",{staticClass:"nav-link",attrs:{"data-toggle":"tab",href:"#nav-profile",role:"tab","aria-controls":"nav-profile","aria-selected":"false",to:"#"}},[e._v("推文和回覆")])],1),s("li",{staticClass:"nav-item",on:{click:function(t){return e.showtweets("liked")}}},[s("router-link",{staticClass:"nav-link",attrs:{"data-toggle":"tab",href:"#nav-contact",role:"tab","aria-controls":"nav-contact","aria-selected":"false",to:"#"}},[e._v("喜歡的內容")])],1)]),e.isLoading?s("Spinner"):["userTweet"===e.nowPage&&e.userTweets.length>0?s("div",{staticClass:"tweet-cards"},e._l(e.userTweets,(function(t){return s("TweetCards",{key:t.id,attrs:{"initial-user-tweet":t},on:{"after-add-like":e.afterAddLike,"after-delete-like":e.afterDeleteLike}})})),1):"userTweet"!==e.nowPage||0!==e.userTweets.length||e.isFirstLoad?e._e():s("div",{staticClass:"nodata-sign"},[e._v("使用者尚無推文")]),"replied"===e.nowPage&&e.replieds.length>0?s("div",{staticClass:"tweet-cards"},e._l(e.replieds,(function(t){return s("RepliedLikedTweetCards",{key:t.id,attrs:{"initial-user-tweet":t},on:{"after-add-like":e.afterAddLike,"after-delete-like":e.afterDeleteLike}})})),1):e._e(),"replied"===e.nowPage&&0===e.replieds.length?s("div",{staticClass:"nodata-sign"},[e._v("使用者尚無回覆")]):e._e(),"liked"===e.nowPage&&e.likeds.length>0?s("div",{staticClass:"tweet-cards"},e._l(e.likeds,(function(t){return s("RepliedLikedTweetCards",{key:t.id,attrs:{"initial-user-tweet":t},on:{"after-add-like":e.afterAddLike,"after-delete-like":e.afterDeleteLike}})})),1):e._e(),"liked"===e.nowPage&&0===e.likeds.length?s("div",{staticClass:"nodata-sign"},[e._v("使用者尚無按讚")]):e._e()]],2)},l=[],u=r("8f83"),d=r("e473"),f=r("2375"),w=r("4cce"),h=r("2708"),p=r("2fa3"),g=r("2f62"),v={mixins:[h["a"]],components:{TweetCards:u["a"],Spinner:f["a"],RepliedLikedTweetCards:d["a"]},props:{initialUser:{type:Object,required:!0}},data:function(){return{user:{},userTweets:[],replieds:[],likeds:[],nowPage:"userTweet",isLoading:!0,isLoad:!1,isFirstLoad:!0}},watch:{initialUser:function(e){this.user=Object(i["a"])(Object(i["a"])({},this.user),e)},deep:!0},computed:Object(i["a"])({},Object(g["b"])(["currentUser"])),created:function(){this.fetchUser(),this.fetchUserTweets(),this.fetchUserRepliedTweets(),this.fetchUserLikedTweets(),this.showtweets(this.nowPage)},methods:{fetchUser:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.user=e.initialUser;case 1:case"end":return t.stop()}}),t)})))()},fetchUserTweets:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r,s,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,r=e.currentUser.id,t.next=4,w["a"].getUserTweets({userId:r});case 4:if(s=t.sent,a=s.data,"error"!==a.status){t.next=8;break}throw new Error(a.message);case 8:e.userTweets=a,e.userTweets=e.userTweets.sort((function(e,t){return e=new Date(e.createdAt),t=new Date(t.createdAt),t-e})),e.isLoading=!1,e.isFirstLoad=!1,t.next=20;break;case 14:t.prev=14,t.t0=t["catch"](0),e.isLoading=!1,e.isFirstLoad=!1,console.log(t.t0.message),p["a"].fire({icon:"error",title:"無法取得使用者推文，請稍後再試"});case 20:case"end":return t.stop()}}),t,null,[[0,14]])})))()},fetchUserRepliedTweets:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r,s,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,r=e.currentUser.id,t.next=4,w["a"].getRepliedTweets({userId:r});case 4:if(s=t.sent,a=s.data,"error"!==a.status){t.next=8;break}throw new Error(a.message);case 8:if("使用者尚未回覆任何推文"!==a.message){t.next=10;break}return t.abrupt("return");case 10:e.replieds=a,e.replieds=e.replieds.sort((function(e,t){return e=new Date(e.createdAt),t=new Date(t.createdAt),t-e})),e.isLoading=!1,t.next=20;break;case 15:t.prev=15,t.t0=t["catch"](0),e.isLoading=!1,console.log(t.t0.message),p["a"].fire({icon:"error",title:"無法取得使用者回覆過的推文，請稍後再試"});case 20:case"end":return t.stop()}}),t,null,[[0,15]])})))()},fetchUserLikedTweets:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r,s,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,r=e.currentUser.id,t.next=4,w["a"].getLikedTweets({userId:r});case 4:if(s=t.sent,a=s.data,"error"!==a.status){t.next=8;break}throw new Error(a.message);case 8:if("使用者尚未按任何推文讚"!==a.message){t.next=10;break}return t.abrupt("return");case 10:e.likeds=a,e.likeds=e.likeds.sort((function(e,t){return e=new Date(e.createdAt),t=new Date(t.createdAt),t-e})),e.isLoading=!1,t.next=20;break;case 15:t.prev=15,t.t0=t["catch"](0),e.isLoading=!1,console.log(t.t0.message),p["a"].fire({icon:"error",title:"無法取得使用者喜歡的推文，請稍後再試"});case 20:case"end":return t.stop()}}),t,null,[[0,15]])})))()},showtweets:function(e){this.nowPage=e},afterAddLike:function(){this.fetchUserTweets(),this.fetchUserRepliedTweets(),this.fetchUserLikedTweets()},afterDeleteLike:function(){this.fetchUserTweets(),this.fetchUserRepliedTweets(),this.fetchUserLikedTweets()}}},b=v,m=(r("4939"),r("2877")),k=Object(m["a"])(b,c,l,!1,null,"79300cae",null),C=k.exports,U=r("ab71"),_=r("9fe7"),T=r("0c9e"),x=r("1157"),L=r.n(x),P={components:{Navbar:o["a"],CurrentUserCard:C,UserPageEdit:U["a"],TweetCreate:_["a"],MostFollowerUserRecommend:T["a"]},data:function(){return{User:{},isProcessing:!1,nowPage:"profile",isLoading:!0,componentKey:0}},computed:Object(i["a"])({},Object(g["b"])(["currentUser"])),created:function(){this.fetchUser()},methods:{fetchUser:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r,s,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,r=e.currentUser.id,t.next=4,w["a"].get({userId:r});case 4:s=t.sent,a=s.data,e.User=a,t.next=13;break;case 9:t.prev=9,t.t0=t["catch"](0),console.log("error",t.t0),p["a"].fire({icon:"error",title:"無法取得資料，請稍後再試"});case 13:case"end":return t.stop()}}),t,null,[[0,9]])})))()},handleAfterSubmit:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var s,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,t.isProcessing=!0,r.next=4,w["a"].updateProfile({userId:t.currentUser.id,formData:e});case 4:if(s=r.sent,a=s.data,"success"===a.status){r.next=8;break}throw new Error(a.message);case 8:p["a"].fire({icon:"success",title:"更新成功"}),t.componentKey+=1,t.fetchUser(),L()("#user-edit-modal").modal("hide"),t.isProcessing=!1,r.next=20;break;case 15:r.prev=15,r.t0=r["catch"](0),t.isProcessing=!1,console.log("error",r.t0),p["a"].fire({icon:"error",title:"無法更新個人資料，請稍後再試"});case 20:case"end":return r.stop()}}),r,null,[[0,15]])})))()},afterCreateTweet:function(){this.componentKey+=1},afteraddFollowUser:function(){this.User=Object(i["a"])(Object(i["a"])({},this.User),{},{followingCount:this.User.followingCount+1})},afterdeleteFollowUser:function(){this.User=Object(i["a"])(Object(i["a"])({},this.User),{},{followingCount:this.User.followingCount-1})}}},R=P,y=Object(m["a"])(R,s,a,!1,null,null,null);t["default"]=y.exports},4939:function(e,t,r){"use strict";var s=r("b423"),a=r.n(s);a.a},b423:function(e,t,r){}}]);
//# sourceMappingURL=chunk-a473badc.d5244aca.js.map