(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a8835056"],{"19bc":function(e,t,r){"use strict";var s=r("6e25"),a=r.n(s);a.a},"36da":function(e,t,r){"use strict";var s=r("d4dd"),a=r.n(s);a.a},"495d":function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container"},[r("Navbar"),r("div",{staticClass:"center-area",staticStyle:{width:"33rem"}},[r("UserCard",{attrs:{"initial-user":e.User}}),r("ul",{staticClass:"nav nav-pills",attrs:{id:"nav-tab",role:"tablist"}},[r("li",{staticClass:"nav-item",on:{click:function(t){return e.showtweets("userTweet")}}},[r("router-link",{staticClass:"nav-link active",attrs:{to:"#","data-toggle":"tab",href:"#nav-home",role:"tab","aria-controls":"nav-home","aria-selected":"true"}},[e._v("推文")])],1),r("li",{staticClass:"nav-item",on:{click:function(t){return e.showtweets("replied")}}},[r("router-link",{staticClass:"nav-link",attrs:{"data-toggle":"tab",href:"#nav-profile",role:"tab","aria-controls":"nav-profile","aria-selected":"false",to:"#"}},[e._v("推文和回覆")])],1),r("li",{staticClass:"nav-item",on:{click:function(t){return e.showtweets("liked")}}},[r("router-link",{staticClass:"nav-link",attrs:{"data-toggle":"tab",href:"#nav-contact",role:"tab","aria-controls":"nav-contact","aria-selected":"false",to:"#"}},[e._v("喜歡的內容")])],1)]),e.isLoading?r("Spinner"):["userTweet"===e.nowPage?r("div",{staticClass:"tweet-cards"},e._l(e.userTweets,(function(t){return r("TweetCards",{key:t.id,attrs:{"initial-user-tweet":t},on:{"after-add-like":e.afterAddLike,"after-delete-like":e.afterDeleteLike}})})),1):e._e(),"userTweet"!==e.nowPage||0!==e.userTweets.length||e.isFirstLoad?e._e():r("div",{staticClass:"nodata-sign"},[e._v("使用者尚無推文")]),"replied"===e.nowPage?r("div",{staticClass:"tweet-cards"},e._l(e.replieds,(function(t){return r("RepliedLikedTweetCards",{key:t.id,attrs:{"initial-user-tweet":t},on:{"after-add-like":e.afterAddLike,"after-delete-like":e.afterDeleteLike}})})),1):e._e(),"replied"===e.nowPage&&0===e.replieds.length?r("div",{staticClass:"nodata-sign"},[e._v("使用者尚無回覆")]):e._e(),"liked"===e.nowPage&&e.likeds.length>0?r("div",{staticClass:"tweet-cards"},e._l(e.likeds,(function(t){return r("RepliedLikedTweetCards",{key:t.id,attrs:{"initial-user-tweet":t},on:{"after-add-like":e.afterAddLike,"after-delete-like":e.afterDeleteLike}})})),1):e._e(),"liked"===e.nowPage&&0===e.likeds.length?r("div",{staticClass:"nodata-sign"},[e._v("使用者尚無按讚")]):e._e()]],2),r("MostFollowerUserRecommend",{on:{"after-add-follow-user":e.afteraddFollowUser,"after-delete-follow-user":e.afterdeleteFollowUser}}),r("UserPageEdit",{attrs:{"initial-user":e.User,"initial-is-processing":e.isProcessing},on:{"after-submit":e.handleAfterSubmit}}),r("TweetCreate",{on:{"after-create-tweet":e.afterCreateTweet}})],1)},a=[],n=(r("96cf"),r("1da1")),i=r("5530"),o=r("d178"),c=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"header"},[s("button",{staticClass:"header-button",attrs:{type:"button"},on:{click:function(t){return e.$router.back()}}},[e._v("←")]),s("div",{staticClass:"header-text m-3"},[s("p",{staticClass:"header-name"},[e._v(e._s(e.user.name))]),s("p",{staticClass:"header-userTweets"},[e._v(e._s(e.user.tweetCount)+"推文")])])]),s("img",{staticClass:"card-img-top backgroundImage",attrs:{src:e._f("emptyImage")(e.user.cover),height:"150px"}}),s("div",{staticClass:"card-body"},[s("img",{staticClass:"card-img-avatar",attrs:{src:e._f("emptyImage")(e.user.avatar),height:"140px",width:"140px"}}),s("div",{staticClass:"card-body-button"},[e.currentUser.id===this.user.id?s("button",{staticClass:"btn edit-profile-button",attrs:{"data-toggle":"modal","data-target":"#user-edit-modal"}},[e._v("編輯個人資料")]):s("button",{staticClass:"button-transparent"},[s("img",{attrs:{src:r("1cfa")}})]),e.user.isBelled&&e.currentUser.id!==this.user.id?s("button",{staticClass:"button-transparent-active",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.deleteBell(t)}}},[s("img",{attrs:{src:r("5e13")}})]):e._e(),e.user.isBelled||e.currentUser.id===this.user.id?e._e():s("button",{staticClass:"button-transparent",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.addBell(t)}}},[s("img",{attrs:{src:r("fd6e")}})]),e.user.isFollowedByLoginUser||e.currentUser.id===this.user.id?e._e():s("button",{staticClass:"btn button-follow",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.addFollow(e.user.id)}}},[e._v("跟隨")]),e.user.isFollowedByLoginUser&&e.currentUser.id!==this.user.id?s("button",{staticClass:"btn button-following",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.deleteFollow(e.user.id)}}},[e._v("正在跟隨")]):e._e()]),s("div",{staticClass:"card-body-text"},[s("h5",{staticClass:"card-body-name"},[e._v(e._s(e.user.name))]),s("p",{staticClass:"card-body-account"},[e._v("@"+e._s(e.user.account))]),s("p",{staticClass:"card-body-introduction"},[e._v(e._s(e.user.introduction))])]),s("div",{staticClass:"card-body-follow"},[s("router-link",{attrs:{to:{name:"user-following",params:{id:e.$route.params.id}}}},[e._v(" "+e._s(e.user.followingCount)+" 個 "),s("span",[e._v("跟隨中")])]),s("router-link",{attrs:{to:{name:"user-follower",params:{id:e.$route.params.id}}}},[e._v(" "+e._s(e.user.followerCount)+" 位 "),s("span",[e._v("跟隨者")])])],1)])])},l=[],u=(r("d3b7"),r("25f0"),r("2708")),d=r("2fa3"),f=r("2f62"),w=r("4cce"),h={mixins:[u["a"]],props:{initialUser:{type:Object,required:!0}},data:function(){return{user:{}}},watch:{initialUser:function(e){this.user=Object(i["a"])(Object(i["a"])({},this.user),e)},deep:!0},computed:Object(i["a"])({},Object(f["b"])(["currentUser"])),created:function(){this.fetchUser()},methods:{fetchUser:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.user=e.initialUser,console.log(333,e.user);case 2:case"end":return t.stop()}}),t)})))()},addFollow:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var s,a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,s=e.toString(),r.next=4,w["a"].addFollowing({id:s});case 4:if(a=r.sent,n=a.data,"success"===n.status){r.next=8;break}throw new Error(n.message);case 8:t.user=Object(i["a"])(Object(i["a"])({},t.user),{},{isFollowedByLoginUser:!0,followerCount:t.user.followerCount+1}),r.next=15;break;case 11:r.prev=11,r.t0=r["catch"](0),console.log(r.t0.message),d["a"].fire({icon:"error",title:r.t0.message});case 15:case"end":return r.stop()}}),r,null,[[0,11]])})))()},deleteFollow:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var s,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,w["a"].deleteFollowing({userId:e});case 3:if(s=r.sent,a=s.data,"error"!==a.status){r.next=7;break}throw new Error(a.message);case 7:"success"===a.status&&d["a"].fire({icon:"success",title:"取消追蹤！"}),t.user=Object(i["a"])(Object(i["a"])({},t.user),{},{isFollowedByLoginUser:!1,followerCount:t.user.followerCount-1}),r.next=15;break;case 11:r.prev=11,r.t0=r["catch"](0),console.log(r.t0.message),d["a"].fire({icon:"error",title:"無法取消追蹤使用者稍後再試"});case 15:case"end":return r.stop()}}),r,null,[[0,11]])})))()},addBell:function(){this.user=Object(i["a"])(Object(i["a"])({},this.user),{},{isBelled:!0})},deleteBell:function(){this.user=Object(i["a"])(Object(i["a"])({},this.user),{},{isBelled:!1})}}},p=h,g=(r("36da"),r("2877")),v=Object(g["a"])(p,c,l,!1,null,"dd8fbb66",null),b=v.exports,m=r("8f83"),k=r("9fe7"),U=r("ab71"),C=r("2375"),_=r("0c9e"),T=r("e473"),x=r("1157"),j=r.n(x),O={components:{Navbar:o["a"],UserCard:b,TweetCards:m["a"],TweetCreate:k["a"],UserPageEdit:U["a"],MostFollowerUserRecommend:_["a"],Spinner:C["a"],RepliedLikedTweetCards:T["a"]},data:function(){return{User:{},isProcessing:!1,nowPage:"userTweet",tweets:[],userTweets:[],replieds:[],likeds:[],isLoading:!0,isFirstLoad:!0}},computed:Object(i["a"])({},Object(f["b"])(["currentUser"])),created:function(){var e=this.$route.params.id;this.fetchUser(e),this.fetchUserTweets(e),this.fetchUserRepliedTweets(e),this.fetchUserLikedTweets(e)},beforeRouteUpdate:function(e,t,r){var s=e.params.id;this.fetchUser(s),this.fetchUserTweets(s),this.fetchUserRepliedTweets(s),this.fetchUserLikedTweets(s),r()},methods:{fetchUser:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var s,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,w["a"].get({userId:e});case 3:s=r.sent,a=s.data,t.User=a,r.next=12;break;case 8:r.prev=8,r.t0=r["catch"](0),console.log(r.t0.message),d["a"].fire({icon:"error",title:"無法取得使用者資料，請稍後再試"});case 12:case"end":return r.stop()}}),r,null,[[0,8]])})))()},fetchUserTweets:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var s,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,w["a"].getUserTweets({userId:e});case 3:if(s=r.sent,a=s.data,"error"!==a.status){r.next=7;break}throw new Error(a.message);case 7:t.userTweets=a,t.userTweets=t.userTweets.sort((function(e,t){return e=new Date(e.createdAt),t=new Date(t.createdAt),t-e})),t.isLoading=!1,t.isFirstLoad=!1,r.next=18;break;case 13:r.prev=13,r.t0=r["catch"](0),t.isLoading=!1,console.log(r.t0.message),d["a"].fire({icon:"error",title:"無法取得使用者推文，請稍後再試"});case 18:case"end":return r.stop()}}),r,null,[[0,13]])})))()},fetchUserRepliedTweets:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var s,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,w["a"].getRepliedTweets({userId:e});case 3:if(s=r.sent,a=s.data,"error"!==a.status){r.next=7;break}throw new Error(a.message);case 7:if("使用者尚未回覆任何推文"!==a.message){r.next=9;break}return r.abrupt("return");case 9:t.replieds=a,t.replieds=t.replieds.sort((function(e,t){return e=new Date(e.createdAt),t=new Date(t.createdAt),t-e})),t.isLoading=!1,r.next=19;break;case 14:r.prev=14,r.t0=r["catch"](0),t.isLoading=!1,console.log(r.t0.message),d["a"].fire({icon:"error",title:"無法取得使用者回覆過的推文，請稍後再試"});case 19:case"end":return r.stop()}}),r,null,[[0,14]])})))()},fetchUserLikedTweets:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var s,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,w["a"].getLikedTweets({userId:e});case 3:if(s=r.sent,a=s.data,"error"!==a.status){r.next=7;break}throw new Error(a.message);case 7:if("使用者尚未按任何推文讚"!==a.message){r.next=10;break}return t.likeds=[],r.abrupt("return");case 10:t.likeds=a,t.likeds=t.likeds.sort((function(e,t){return e=new Date(e.createdAt),t=new Date(t.createdAt),t-e})),t.isLoading=!1,r.next=20;break;case 15:r.prev=15,r.t0=r["catch"](0),t.isLoading=!1,console.log(r.t0.message),d["a"].fire({icon:"error",title:"無法取得使用者回覆過的推文，請稍後再試"});case 20:case"end":return r.stop()}}),r,null,[[0,15]])})))()},showtweets:function(e){this.nowPage=e},handleAfterSubmit:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var s,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,t.isProcessing=!0,r.next=4,w["a"].updateProfile({userId:t.currentUser.id,formData:e});case 4:if(s=r.sent,a=s.data,"success"===a.status){r.next=8;break}throw new Error(a.message);case 8:d["a"].fire({icon:"success",title:"更新成功"}),j()("#user-edit-modal").modal("hide"),t.fetchUser(t.currentUser.id),t.isProcessing=!1,r.next=19;break;case 14:r.prev=14,r.t0=r["catch"](0),t.isProcessing=!1,console.log("error",r.t0),d["a"].fire({icon:"error",title:"無法更新個人資料，請稍後再試"});case 19:case"end":return r.stop()}}),r,null,[[0,14]])})))()},afterAddLike:function(){var e=this.$route.params.id;this.fetchUser(e),this.fetchUserTweets(e),this.fetchUserRepliedTweets(e),this.fetchUserLikedTweets(e)},afterDeleteLike:function(){var e=this.$route.params.id;this.fetchUser(e),this.fetchUserTweets(e),this.fetchUserRepliedTweets(e),this.fetchUserLikedTweets(e)},afterCreateTweet:function(){var e=this.$route.params.id;this.fetchUserTweets(e)},afteraddFollowUser:function(){this.currentUser.id!==this.User.id?this.User=Object(i["a"])(Object(i["a"])({},this.User),{},{followerCount:this.User.followerCount+1}):this.User=Object(i["a"])(Object(i["a"])({},this.User),{},{followingCount:this.User.followingCount+1})},afterdeleteFollowUser:function(){this.currentUser.id!==this.User.id?this.User=Object(i["a"])(Object(i["a"])({},this.User),{},{followerCount:this.User.followerCount-1}):this.User=Object(i["a"])(Object(i["a"])({},this.User),{},{followingCount:this.User.followingCount-1})}}},L=O,R=(r("19bc"),Object(g["a"])(L,s,a,!1,null,"2d473ed1",null));t["default"]=R.exports},"6e25":function(e,t,r){},d4dd:function(e,t,r){}}]);
//# sourceMappingURL=chunk-a8835056.10820f46.js.map