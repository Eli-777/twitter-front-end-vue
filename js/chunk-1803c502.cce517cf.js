(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1803c502"],{1185:function(e,t,r){"use strict";var a=r("18f5"),i=r.n(a);i.a},"18f5":function(e,t,r){},"5b0e":function(e,t,r){},"6f1a":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container"},[r("Navbar"),r("div",{staticClass:"center-area",staticStyle:{width:"33rem"}},[r("TweetCardDetail",{attrs:{"initial-tweet":e.tweet}}),e.isLoading?r("Spinner"):[e._l(e.replieds,(function(e){return r("RepliedCards",{key:e.id,attrs:{"initial-replied":e}})})),e.hasReplied?e._e():r("div",{staticClass:"noReply"},[e._v("此推文還沒有人留言唷")])]],2),r("RepliedModal",{attrs:{tweet:e.tweet},on:{"after-create-replied":e.afterCreateReplied}}),r("TweetCreate"),r("MostFollowerUserRecommend")],1)},i=[],n=(r("a4d3"),r("e01a"),r("b0c0"),r("96cf"),r("1da1")),s=r("5530"),c=r("d178"),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"header m-3"},[a("button",{staticClass:"header-button",attrs:{type:"button"},on:{click:function(t){return e.$router.back()}}},[e._v("←")]),a("p",{staticClass:"header-text"},[e._v("推文")])]),a("div",{staticClass:"card-body pt-2"},[a("div",{staticClass:"card-body-user pl-3"},[a("router-link",{attrs:{to:{name:"user-tweets",params:{id:e.tweet.User.id}}}},[a("img",{staticClass:"card-img-avatar",attrs:{src:e._f("emptyImage")(e.tweet.User.avatar),height:"140px",width:"140px"}})]),a("div",{staticClass:"card-body-username "},[a("h5",{staticClass:"card-body-name"},[e._v(e._s(e.tweet.User.name))]),a("p",{staticClass:"card-body-account"},[e._v("@"+e._s(e.tweet.User.account))])])],1),a("p",{staticClass:"card-body-description pl-3"},[e._v(e._s(e.tweet.description))]),a("p",{staticClass:"card-body-time pl-3"},[e._v(e._s(e._f("fromNow")(e.tweet.createdAt)))]),a("div",{staticClass:"card-body-follow pl-3"},[e._v(" "+e._s(e.tweet.commentCount)+" "),a("p",[e._v("回覆")]),e._v(" "+e._s(e.tweet.likeCount)+" "),a("p",[e._v("喜歡次數")])]),a("div",{staticClass:"card-icon pl-3 pb-2"},[e._m(0),e.tweet.isLikedByLoginUser?a("button",{attrs:{type:"button"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.deleteLike(e.tweet.id)}}},[a("img",{attrs:{src:r("c52c"),alt:""}})]):a("button",{attrs:{type:"button"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.addLike(e.tweet.id)}}},[a("img",{attrs:{src:r("8e44"),alt:""}})])])])])},d=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("button",{attrs:{type:"button mr-5","data-toggle":"modal","data-target":"#tweet-replied-modal"}},[a("img",{attrs:{src:r("771f"),alt:""}})])}],l=r("2708"),u=r("4cce"),p=r("2fa3"),m={mixins:[l["a"],l["b"]],props:{initialTweet:{type:Object,required:!0}},data:function(){return{tweet:{id:-1,description:"",commentCount:0,likeCount:0,isLikedByLoginUser:!1,createdAt:"",updatedAt:"",User:{id:-1,name:"",avatar:"",account:""}},replieds:[]}},watch:{initialTweet:function(e){this.tweet=Object(s["a"])(Object(s["a"])({},this.tweet),e)}},created:function(){this.fetchTweet()},methods:{fetchTweet:function(){this.tweet=Object(s["a"])(Object(s["a"])({},this.tweet),this.initialTweet)},addLike:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var a,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,u["a"].addliked({tweetId:e});case 3:if(a=r.sent,i=a.data,"error"!==i.status){r.next=7;break}throw new Error(i.message);case 7:t.tweet.isLikedByLoginUser=!0,t.tweet.likeCount=t.tweet.likeCount+1,r.next=15;break;case 11:r.prev=11,r.t0=r["catch"](0),console.log(r.t0.message),p["a"].fire({icon:"error",title:"無法對推文按讚，請稍後再試"});case 15:case"end":return r.stop()}}),r,null,[[0,11]])})))()},deleteLike:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var a,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,u["a"].deleteliked({tweetId:e});case 3:if(a=r.sent,i=a.data,"error"!==i.status){r.next=7;break}throw new Error(i.message);case 7:t.tweet.isLikedByLoginUser=!1,t.tweet.likeCount=t.tweet.likeCount-1,r.next=15;break;case 11:r.prev=11,r.t0=r["catch"](0),console.log(r.t0.message),p["a"].fire({icon:"error",title:"無法對推文取消按讚，請稍後再試"});case 15:case"end":return r.stop()}}),r,null,[[0,11]])})))()}}},f=m,w=(r("1185"),r("2877")),h=Object(w["a"])(f,o,d,!1,null,"44acb142",null),v=h.exports,b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.replied?a("div",{staticClass:"tweetcard"},[a("router-link",{attrs:{to:{name:"user-tweets",params:{id:e.replied.User.id}}}},[a("img",{staticClass:"tweetcard-avatar",attrs:{src:e._f("emptyImage")(e.replied.User.avatar),width:"50rem",height:"50rem"}})]),a("div",{staticClass:"tweetcard-right"},[a("div",{staticClass:"tweetcard-title"},[e._v(" "+e._s(e.replied.User.name)+" "),a("span",{staticClass:"tweetcard-account"},[e._v(" @"+e._s(e.replied.User.account)+" ．"+e._s(e._f("fromNow")(e.replied.createdAt))+" ")])]),a("div",{staticClass:"tweetcard-content"},[e._v(e._s(e.replied.comment))]),a("div",{staticClass:"tweetcard-icon"},[e._m(0),e._v(" "+e._s(e._f("numberNotNull")(e.replied.commentCount))+" "),e.replied.isLiked?a("button",{attrs:{type:"button"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.deleteLike(e.replied.id)}}},[a("img",{attrs:{src:r("c52c"),alt:""}})]):a("button",{attrs:{type:"button"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.addLike(e.replied.id)}}},[a("img",{attrs:{src:r("8e44"),alt:""}})]),e._v(" "+e._s(e._f("numberNotNull")(e.replied.likeCount))+" ")])])],1):e._e()},g=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("button",{attrs:{type:"button"}},[a("img",{attrs:{src:r("771f"),alt:""}})])}],k={mixins:[l["b"],l["a"]],props:{initialReplied:{type:Object,required:!0}},data:function(){return{replied:{id:-1,comment:"",createdAt:"",likedCount:0,isLiked:!1,User:{id:-1,name:"",account:"",avatar:""}}}},watch:{initialReplied:function(e){this.replied=Object(s["a"])(Object(s["a"])({},this.replied),e)}},created:function(){this.replied=this.initialReplied},methods:{addLike:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:try{console.log(e),t.replied.isLiked=!0,t.replied.likeCount=t.replied.likedCount+1}catch(a){console.log(a.message),p["a"].fire({icon:"error",title:"無法對回覆按讚，請稍後再試"})}case 1:case"end":return r.stop()}}),r)})))()},deleteLike:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:try{console.log(e),t.replied.isLiked=!1,t.replied.likeCount=t.replied.likedCount-1}catch(a){console.log(a.message),p["a"].fire({icon:"error",title:"無法對回覆按讚，請稍後再試"})}case 1:case"end":return r.stop()}}),r)})))()}},filters:{numberNotNull:function(e){return e||0}}},C=k,_=(r("e5ed"),Object(w["a"])(C,b,g,!1,null,"62fa6a3f",null)),y=_.exports,R=r("0262"),L=r("9fe7"),U=r("0c9e"),x=r("2375"),j=r("6783"),O=r("2f62"),T={components:{Navbar:c["a"],TweetCardDetail:v,RepliedCards:y,RepliedModal:R["a"],TweetCreate:L["a"],MostFollowerUserRecommend:U["a"],Spinner:x["a"]},data:function(){return{tweet:{id:-1,description:"",commentCount:0,likeCount:0,isLikedByLoginUser:!1,createdAt:"",updatedAt:"",User:{id:-1,name:"",avatar:"",account:""}},replieds:[],hasReplied:!0,isLoading:!0}},computed:Object(s["a"])({},Object(O["b"])(["currentUser"])),created:function(){var e=this.$route.params.id;this.fetchTweet(e),this.fetchReplies(e)},methods:{fetchTweet:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var a,i,n,s,c,o,d,l,u;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,j["a"].getTweet({tweetId:e});case 3:if(a=r.sent,i=a.data,n=i.id,s=i.description,c=i.commentCount,o=i.likeCount,d=i.isLikedByLoginUser,l=i.createdAt,u=i.User,t.tweet={id:n,description:s,commentCount:c,likeCount:o,isLikedByLoginUser:d,createdAt:l,User:u},"error"!==i.status){r.next=9;break}throw new Error(i.message);case 9:r.next=15;break;case 11:r.prev=11,r.t0=r["catch"](0),console.log(r.t0.message),p["a"].fire({icon:"error",title:"無法取得該推文資料，請稍後再試"});case 15:case"end":return r.stop()}}),r,null,[[0,11]])})))()},fetchReplies:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var a,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,j["a"].getTweetReplies({tweetId:e});case 3:if(a=r.sent,i=a.data,t.replieds=i,"error"!==i.status){r.next=8;break}throw new Error(i.message);case 8:"推文尚未有任何回覆"===i.message&&(t.hasReplied=!1,t.replieds=[]),t.isLoading=!1,r.next=17;break;case 12:r.prev=12,r.t0=r["catch"](0),t.isLoading=!1,console.log(r.t0.message),p["a"].fire({icon:"error",title:"無法取得該留言資料，請稍後再試"});case 17:case"end":return r.stop()}}),r,null,[[0,12]])})))()},afterCreateReplied:function(e){var t=e.text;this.replieds.unshift({User:{id:this.currentUser.id,name:this.currentUser.name,account:this.currentUser.account,avatar:this.currentUser.avatar},comment:t,createdAt:new Date}),this.hasReplied=!0}}},A=T,N=(r("ec3c"),Object(w["a"])(A,a,i,!1,null,"9c2f3142",null));t["default"]=N.exports},c100:function(e,t,r){},e5ed:function(e,t,r){"use strict";var a=r("c100"),i=r.n(a);i.a},ec3c:function(e,t,r){"use strict";var a=r("5b0e"),i=r.n(a);i.a}}]);
//# sourceMappingURL=chunk-1803c502.cce517cf.js.map